<?xml version="1.0" encoding="UTF-8" ?>  
<!DOCTYPE mapper PUBLIC "-//ibatis.apache.org//DTD Mapper 3.0//EN"      
 "http://ibatis.apache.org/dtd/ibatis-3-mapper.dtd">

	<mapper namespace="dao.UserDao">
	
	
		<select id="findUserByUsername" parameterType="string" resultType="entity.User">
			select 
				 username,password 
			from 
				user
			where 
				sts='A'
				and username=#{username}
			
		</select>
		
		<insert id="addUser" parameterType="entity.User" >
			insert into user 
				(username,password,sts)
			values
				(#{username},#{password},'A')
	 		
		</insert>
		
		<select id="queryPagerList" parameterType="Map" resultType="entity.User">
			select 
				 id,username,password 
			from 
				user
			where
				1=1 and sts='A'
			<if test="username != null and username!= '' ">
				and username like concat('%',#{username},'%')
			</if>
			<if test="password != null and password!= ''">
				 and password = #{password}
			</if>
			<if test="limit != '-1' and offset != '-1' ">
			limit #{offset},#{limit}
			</if>
			
		</select>
		
		<select id="getTotal" parameterType="entity.User" resultType="Integer">
			select 
				 count(*)
			from 
				user
			where
				1=1  and sts='A'
			<if test="username != null and username != '' ">
				and username like concat('%',#{username},'%')
			</if>
			<if test="password != null and password != ''">
				 and password=#{password}
			</if>
			
		</select>
		
		<select id="queryBean" parameterType="entity.User" resultType="entity.User">
			select 
				 id,username,password,sts,nickname,email,person_sign,registe_time,login_ip,role_id,birth
			from 
				user
			where 
				1=1 and sts='A'
			<if test="id != null and id!= '' ">
				and id=#{id}
			</if>
			<if test="username != null and username != '' ">
				and username=#{username}
			</if>
			<if test="password != null and username != '' ">
				and password=#{password}
			</if>
			<if test="sts != null and sts != '' ">
				and sts=#{sts}
			</if>
			<if test="nickname != null and nickname!= '' ">
				and nickname = #{nickname}
			</if>
			<if test="email != null and email!= '' ">
				and email = #{email}
			</if>
			<if test="person_sign != null and person_sign!= '' ">
				and person_sign = #{person_sign}
			</if>
			<if test="registe_time != null and registe_time!= '' ">
				and registe_time = #{registe_time}
			</if>
			<if test="login_ip != null and login_ip!= '' ">
				and login_ip = #{login_ip}
			</if>
			<if test="birth != null and birth!= '' ">
				and birth = #{birth}
			</if>
			
		</select>
		
		<update id="updateUser" parameterType="entity.User">
			update user
			<set>
				<if test="id != null and id!= '' ">
					id = #{id},  
				</if>
				<if test="username != null and username!= '' ">
					username = #{username},  
				</if>
				<if test="password != null and password!= '' ">
					password = #{password},  
				</if>
				<if test="sts != null and sts!= '' ">
					sts = #{sts}, 
				</if>
				<if test="nickname != null and nickname!= '' ">
					nickname = #{nickname},
				</if>
				<if test="email != null and email!= '' ">
					email = #{email},
				</if>
				<if test="person_sign != null and person_sign!= '' ">
					person_sign = #{person_sign},
				</if>
				<if test="registe_time != null and registe_time!= '' ">
					registe_time = #{registe_time},
				</if>
				<if test="login_ip != null and login_ip!= '' ">
					login_ip = #{login_ip},
				</if>
				<if test="birth != null and birth!= '' ">
					birth = #{birth},
				</if>
			</set>
			where id = #{id} and sts='A'
		</update>
		
	</mapper>








